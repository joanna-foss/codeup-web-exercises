<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>MAPBOX MAPS</title>
	<!-- Mapbox CSS -->
	<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet'/>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
	      integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
	<!-- Custom CSS -->
	<style>
		#map {
			width: 85%;
			height: 400px;
		}
		
		#fly{
			font-family: monospace;
			font-size: 2em;
		}
	</style>
</head>
<body>
<div class="container">
	<h1 class="text-center">MAPBOX</h1>
	
	<div id='map' class="mx-auto"></div>
	
	<div class="text-center"><button id="fly" class="btn-dark w-75 m-5">Let's Fly!</button></div>
</div>

<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
<script src="js/mapbox-geocoder-utils.js"></script>
<script src="keys.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
        crossorigin="anonymous"></script>
<!-- Custom JS -->
<script>

geocode("Shreveport", mapboxAPIKey).then(function(e){
	console.log(e);
	
	let start = [-98.7088, 29.4914]; //Yum Thai
	let end = [-88.93682, 30.4030]; //R&C Korean
	let isAtStart = true;
	
	let accessToken = mapboxAPIKey;
	mapboxgl.accessToken = accessToken;
	let map = new mapboxgl.Map({
		container: 'map',
		style: 'mapbox://styles/mapbox/outdoors-v11',
		zoom: 10,
		center: start,
		pitch: 50
	});
	
	let arrayOfFavs = [
		{
			name: "R&C Korean",
			LngLat: [-88.93682, 30.4030],
			addy: "",
			info: "A Korean restaurant"
		},
		{
			name: "Yum Thai",
			LngLat: [-98.7088, 29.4914],
			addy: "",
			info: "A Thai restaurant"
		},
		{
			name: "Sucre",
			LngLat: [-90.0547, 30.0366],
			addy: "",
			info: "A sweet place"
		}
	]
	
	arrayOfFavs.forEach(function (elem) {
		let pop = new mapboxgl.Popup(elem.name).setHTML("<h1>" + elem.name + "</h1>" + elem.info);
		new mapboxgl.Marker({"color": 'pink'}).setLngLat(elem.LngLat).addTo(map).setPopup(pop);
	});
	
	document.getElementById('fly').addEventListener('click', () => {
		const target = function(){
			if (isAtStart){
				return end;
			} return start;
		}
		
		isAtStart = !isAtStart;
		
		map.flyTo({
// These options control the ending camera position: centered at
// the target, at zoom level 9, and north up.
			center: target,
			zoom: 9,
			bearing: 0,

// These options control the flight curve, making it move
// slowly and zoom out almost completely before starting
// to pan.
			speed: 0.2, // make the flying slow
			curve: 1, // change the speed at which it zooms out

// This can be any easing function: it takes a number between
// 0 and 1 and returns another number between 0 and 1.
			easing: (t) => t,

// this animation is considered essential with respect to prefers-reduced-motion
			essential: true
		});
	})
	
});

</script>
</body>
</html>